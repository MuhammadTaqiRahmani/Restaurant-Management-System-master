<script>
    let = popup = document.getElementByID("popup");
    function openPopup(){
      popup.classList.add("open-popup")
    }
    function closePopup(){
      popup.classList.remove("open-popup")
    }

    function editRole(roleId, role) {
      let popup = document.getElementById("popup");
      let roleInput = document.getElementById("exampleInputUsername1");
      let saveButton = document.querySelector("#buttons button[type='submit']");
      
      roleInput.value = role; // Populate the input field with existing role
      
      // Change form action to update role
      document.querySelector("#popup form").action = "/edit_role";
      
      saveButton.textContent = "Update"; // Change save button text
      
      openPopup(); // Open the popup
  }

    function deleteRole(roleId) {
      if (confirm("Are you sure you want to delete this role?")) {
        fetch('/delete_role', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
          },
          body: 'role_id=' + encodeURIComponent(roleId)
        })
        .then(response => {
          if (response.ok) {
            // Reload the page after successful deletion
            location.reload();
          }
        });
      }
    }
  </script>




  <tbody>
    {% for role in roles %}
    <tr>
        <td>{{ role.s_no }}</td>
        <td>{{ role.role }}</td>
        <td class="rightmost">
          <i class="fa-solid fa-trash" id="trash" onclick="deleteRole({{ role.s_no }})"></i>    &nbsp;  &nbsp;    
          <i class="fa-solid fa-pen-to-square" id="edit" onclick="editRole({{ role.s_no }}, '{{ role.role }}')"></i></td>


    </tr>
    {% endfor %}
</tbody>


<div class="popup" id="popup">
    <form action="/category" method="post">
      <div class="form-group">
          <label for="exampleInputUsername1" id="text">Role</label>
          <input type="text" class="form-control" id="exampleInputUsername1" placeholder="Add role" name='role'>
          <div id="buttons">
              <button type="submit" class="btn btn-primary mr-2">Save</button>
              <button type="button" class="btn btn-inverse-dark btn-fw" onclick="closePopup()">Cancel</button>
          </div>
      </div>
  </form>
  
  </div>




















  <script>
    let = popup = document.getElementByID("popup");
    function openPopup(){
      popup.classList.add("open-popup")
    }
    function closePopup(){
      popup.classList.remove("open-popup")
    }

    
    function deleteRole(roleId) {
      if (confirm("Are you sure you want to delete this role?")) {
        fetch('/delete_role', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/x-www-form-urlencoded'
          },
          body: 'role_id=' + encodeURIComponent(roleId)
        })
        .then(response => {
          if (response.ok) {
            // Reload the page after successful deletion
            location.reload();
          }
        });
      }
    }

    let editPopup = document.getElementById("edit-popup");
    let editForm = document.getElementById("edit-form");
    let editRoleIdField = document.getElementById("edit-role-id");
    let editRoleField = document.getElementById("edit-role");

    function openEditPopup(roleId, roleName) {
        editRoleIdField.value = roleId;
        editRoleField.value = roleName;
        editPopup.classList.add("open-popup");
    }

    function closeEditPopup() {
        editPopup.classList.remove("open-popup");
    }
    
  </script>


  <input type="text" class="form-control" id="exampleInputUsername1" placeholder="Edit role" name='role'>